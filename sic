-- Create Dimension Tables
CREATE TABLE Product_Dim (
  Product_ID VARCHAR(10) PRIMARY KEY,
  Product_Name VARCHAR(50),
  Category VARCHAR(30),
  Brand VARCHAR(30)
);

CREATE TABLE Customer_Dim (
  Customer_ID VARCHAR(10) PRIMARY KEY,
  Customer_Name VARCHAR(50),
  Region VARCHAR(30)
);

CREATE TABLE Date_Dim (
  Date_ID VARCHAR(10) PRIMARY KEY,
  Date DATE,
  Month VARCHAR(15),
  Quarter VARCHAR(10),
  Year INT
);

-- Create Fact Table
CREATE TABLE Sales_Fact (
  Sale_ID INT PRIMARY KEY,
  Product_ID VARCHAR(10),
  Customer_ID VARCHAR(10),
  Date_ID VARCHAR(10),
  Quantity INT,
  Total_Amount DECIMAL(10,2),
  FOREIGN KEY (Product_ID) REFERENCES Product_Dim(Product_ID),
  FOREIGN KEY (Customer_ID) REFERENCES Customer_Dim(Customer_ID),
  FOREIGN KEY (Date_ID) REFERENCES Date_Dim(Date_ID)
);
INSERT INTO Product_Dim VALUES 
('P01', 'Laptop', 'Electronics', 'HP'),
('P02', 'Phone', 'Electronics', 'Samsung');

INSERT INTO Customer_Dim VALUES 
('C01', 'Raj', 'North'),
('C02', 'Meena', 'South');

INSERT INTO Date_Dim VALUES 
('D01', '2024-01-01', 'Jan', 'Q1', 2024),
('D02', '2024-02-01', 'Feb', 'Q1', 2024);

INSERT INTO Sales_Fact VALUES
(1, 'P01', 'C01', 'D01', 2, 500),
(2, 'P02', 'C02', 'D02', 1, 300);

SELECT d.Year, d.Month, SUM(f.Total_Amount) AS Total_Sales
FROM Sales_Fact f
JOIN Date_Dim d ON f.Date_ID = d.Date_ID
GROUP BY d.Year, d.Month;

SELECT d.Year, SUM(f.Total_Amount) AS Total_Sales
FROM Sales_Fact f
JOIN Date_Dim d ON f.Date_ID = d.Date_ID
GROUP BY d.Year;

SELECT p.Category, SUM(f.Total_Amount) AS Total_Sales
FROM Sales_Fact f
JOIN Product_Dim p ON f.Product_ID = p.Product_ID
WHERE p.Category = 'Electronics'
GROUP BY p.Category;

SELECT d.Year, c.Region, SUM(f.Total_Amount) AS Total_Sales
FROM Sales_Fact f
JOIN Date_Dim d ON f.Date_ID = d.Date_ID
JOIN Customer_Dim c ON f.Customer_ID = c.Customer_ID
WHERE d.Year = 2024 AND c.Region = 'North'
GROUP BY d.Year, c.Region;

SELECT 
  p.Category,
  SUM(CASE WHEN c.Region = 'North' THEN f.Total_Amount ELSE 0 END) AS North_Sales,
  SUM(CASE WHEN c.Region = 'South' THEN f.Total_Amount ELSE 0 END) AS South_Sales
FROM Sales_Fact f
JOIN Product_Dim p ON f.Product_ID = p.Product_ID
JOIN Customer_Dim c ON f.Customer_ID = c.Customer_ID
GROUP BY p.Category;



